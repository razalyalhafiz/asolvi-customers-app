function _switchTenant(casper, test, tenantName) {
  casper.then(function () {
    casper.echo("Switching tenant to the one with name: " + tenantName);
    casper.waitForUrl("https://manage.auth0.com/#/", null, null, 10000);
    casper.waitUntilVisible(".dropdown.tenant-dropdown .btn-dro.btn-username", function () {
      this.capture('screenshots/SWITCH/01.png');
      this.click(".dropdown.tenant-dropdown .btn-dro.btn-username");
    }, null, 10000);
    casper.wait(1000, function () {
      this.click(".dropdown.tenant-dropdown.open .tenant-switch-btn");
    });
    //New tenant form is shown
    casper.waitUntilVisible('#tenant-selector-pane .tenant-selector-inner.tenant-menu .tenant-item a[href="/switch?tenant=' + tenantName + '&region=stage"]', function () {
      this.capture('screenshots/SWITCH/02.png');
      this.click('#tenant-selector-pane .tenant-selector-inner.tenant-menu .tenant-item a[href="/switch?tenant=' + tenantName + '&region=stage"]');
    });
    casper.wait(10000);
    casper.waitForUrl("https://manage.auth0.com/#/");
    casper.wait(5000, function () {
      this.capture('screenshots/SWITCH/03.png');
    });
  });
}

module.exports = _switchTenant;
